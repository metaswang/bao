server:
  port: ${PORT:8000}
  cors:
    enabled: True
    allow_origins: ["*"]
    allow_methods: ["*"]
    allow_headers: ["*"]
  auth:
    enabled: true
    # python -c 'import base64; print("Basic " + base64.b64encode("secret:key".encode()).decode())'
    # 'secret' is the username and 'key' is the password for basic auth by default
    # If the auth is enabled, this value must be set in the "Authorization" header of the request.
    secret: ${APP_SECRET}

crawler:
  source_type: youtube
  output_dir: data/crawl
  whisper_model: small
  transcript_merge_size: 300
  youtube_short_url_domain: "https://youtu.be"

injest:
  chunk_size: 500
  chunk_overlap: 50
  injest_from: data/crawl
  default_topic: bao

llm:
  mode: openai
  max_new_tokens: 512
  context_window: 3900

embedding:
  mode: local
  embedding_size: 768

vectorstore:
  database: qdrant

qdrant:
  path: data/qdrant_local
  # path: data/qdrant_store_test
  force_disable_check_same_thread: true

local:
  embedding_hf_model_name: intfloat/multilingual-e5-base

anthropic:
  api_key: ${ANTHROPIC_API_KEY}
  eco_model: claude-3-sonnet-20240229
  supper_model: claude-3-opus-20240229

openai:
  api_key: ${OPENAI_API_KEY}
  eco_model: gpt-3.5-turbo-0125
  super_model: gpt-4-0125-preview

google_api:
  api_key: ${GOOGLE_API_KEY}
  model: gemini-pro

reranker:
  enabled: true
  cohere:
    api_key: ${COHERE_API_KEY}  
    k: 8
    model: rerank-multilingual-v2.0

web_ingest:
  enabled: true
  path: "/ingest"

web_chat:
  enabled: True
  # title: "Your Youtube Asistant"
  title: "DC农场 爆料问答机器人"
  header_color: "#6264f5"
  path: "/"
  # path: "/asistant"
  btn_undo: "↩️ 删除上一条"
  btn_clear: "🗑️  清空"
  btn_submit: "提交"
  # btn_undo: "↩️ Delete Previous"
  # btn_clear: "🗑️  Clear"
  # btn_submit: "Submit"
  work_mode: "模式"
  # work_mode_label: "Mode"
  work_modes: 
    - "问答"
    - "搜索"
  # work_modes: 
    # - "Ask Question"
    # - "Search"
  max_history_message_len: 50
  max_history_len: 3
  frequently_asked_questions:
   - "郭文贵是谁?"
   - "我们为什么要消灭中国共产党?"
   - "喜联盟成立的重要意义是什么？"

discord:
  enabled: true
  discord_token: ${DISCORD_TOKEN}
  bot_id: ${DISCORD_BOT_ID}
  chat_history_ttl: 3600
  max_history_len: 5
  max_history_message_len: 100
  reply_mode: true
  fallback_message: >
   (⊙＿⊙') 我没有找到相关资料。如果你有其它问题，请随时提出。  Sorry, I couldn't find relevant information to answer your question. If you have any other questions, please feel free to ask.  
   ✌(-‿-)✌  ✌(-‿-)✌  ✌(-‿-)✌  ✌(-‿-)✌   
   想要搜索资料? 请在问题前加上 */s* 如“/s新中国联邦宣言的内容有哪些？”  
   如要提问，请直接问我 😯  
  frequently_asked_questions:
   - "郭文贵是谁?"
   - "我们为什么要消灭中国共产党?"
   - "喜联盟成立的重要意义是什么？"

retriever:
  k: 12
  # collection_name: llm_lessions
  collection_name: bao
  score_threshold: 0.85
  metadata:
    video: str
    pub_date: str
    source: str
    title: str
    start_at: int
    pub_year: str
    pub_year_month: str
    topic: str
    chunk_no: int


chain_templates:
  intent_classify_model: gpt-3.5
  intent_classify_template: >
    Do not answer the question. Instead, you need to follow below steps to generate a JSON object with following fields to classify the question: type: “greeting”, "miles", “bao" (string) confidence: 0.0 to 1.0 (float)
    Steps:
    1.Intent Recognition: As an expert in the field of knowledge within the Whistleblower Library, you need to combine historical inquiries, analyze the current input text, and then determine the intent of the questioner
    2.当有如下意向时归类为"greeting":
      当提问者想了解我；问我是谁；和我打招呼；问天气；问我能做什么；问吃了吗；问姓名；出生，年龄，性别；属于哪个农场的；农场主是谁；是谁开发的;赞许;感谢;批评;建议等等类似问题。      
    3.请注意，郭先生，郭文贵，郭，或Miles or Miles Guo指同一个人，下面统一称郭文贵
    4.当符合如下意向时归类为"miles":
      想了解郭文贵，如“介绍郭文贵”，“介绍郭文贵爆料”，“郭文贵是谁？为什么要爆料？”，“郭文贵爆谁的料”，“郭文贵出生和背景”，”和8964的联系“，”郭文贵和中国共产党的利益或厉害关系“，”郭文贵为什么被关押“，”郭文贵的家人和员工情况“，”郭文贵相关法律纠纷“，“郭文贵庭审或开庭时间或进展或结果”等等或类似上面的问题。
      想了爆料革命，如”介绍爆料革命“，“郭文贵为什么要爆料？”， “郭先生的爆料的时间线”，”郭爆料涉及主要人物“，”郭先生什么时候开始爆料“，”共产党为什么要阻止郭文贵爆料？“等等， 或类似上面的问题。
    5.当不确定或不能归为上面的类别时，归类为"bao"，比如：
      想了解郭先生对某事或对某人的看法，或类似问题
      其它问题
  answer_model: anthropic-sonnet
  answer_template: >
    你是一位阅读分析和写作领域的专家。请仅使用以下代码块中的内容回答问题，要求准确。如果你不知道答案，请不要回复。请注意当提到人物名称：郭先生，郭文贵和Miles Guo，以上均指同一个人。\nContext:```{context}```
  greeting_model: gemini
  greeting_template: >
    你是文档聊天机器人Bob Washington，请根据三重反引号中的内容回答用户的提问，在回答的最后如果有必要你可以根据如下三重反引号中的信息详细介绍自己，并告诉用户怎么提问。
    你的回答可以是markdown格式，要求回答全面和清晰。如果不清楚，请不要回答：
    ```我的名字是Bob Washington， 我来自喜马拉雅华盛顿农场，2024年2月10日是我的生日。华盛顿DC农场的战友创建了我. 
    我能够为你提供关于爆料革命相关知识和解答，其中涵盖从2017年1月到2023年3月的郭先生的爆料视频。如果回答有不完整或有误的地方请多向农场光明战友提出。也请你根据回答中的参考部分进行参考，如果回答下方没有附带引用参考，请对我的回答保持谨慎态度。你可以按如下几种方式提问：
    1.直接提问，比如：“哪些视频讲财新网和胡舒立？”，“杨改兰女士是中国哪个地方的人？她生前遭受了什么不公？”，“喜联盟成立的意义是？”
    2.如果你已经清楚视频年份月份或日期，可以让回答更有针对性，比如："2020年的视频中，郭先生提到了杨改兰，她遭受了什么？"， "2021年4月27日，郭先生提到了喜币上市，有何重大意义？"
    3.如果你知道视频来源，并能提供视频链接，我的回答会更具针对性。比如：视频https://youtu.be/7D_t9a8faA0  里，郭先生怎么评价青峰看守所的勇士的？
    4.如果你只想搜索，非常简单：在你的问题前面加上 /s, 比如,"/s视频https://youtu.be/7D_t9a8faA0  里，郭先生怎么评价青峰看守所的勇士的？"
    ```
    Input: {question}
    Output:

  query_rewrite_model: anthropic-sonnet
  query_rewrite_template: >
    DO NOT answer the question. Instead, you need to follow below steps one by one to generate a valid JSON object with following fields:
    1. If there's a specific date mentioned for "live stream", "video", or "leak", store it in the "pub-date" field in the yyyyMMdd format (e.g., 20240308 for March 8, year 2024). If no date is explicitly mentioned, leave the "pub-date" field empty.
    2. If there is an explicit year number to describe the live broadcast, video, or news, please store it in the "pub-year" field in yyyy format(e.g., 2024 for year 2024). Otherwise, do not extract it.
    3. If there is an explicit year and month to describe the live broadcast, video, or news, please store it in the "pub-year-month" field in yyyyMM format. Otherwise, do not extract it.
    Please Note: "pub-date", "pub-year", and "pub-year_month" should be in '0'-'9'.
    4. If there is a live broadcast or video playback link, please extract it and store it in the "video" field. Otherwise, do not extract it.
    5. Construct an independent question that can be understood without the chat history. Do not answer the question, just reconstruct it and put it in the "query" field. You need to remove any date, year, month, and links from "query".
    6. Ensemble the above fields into a valid JSON object and then return it.