server:
  port: ${PORT:8000}
  cors:
    enabled: True
    allow_origins: ["*"]
    allow_methods: ["*"]
    allow_headers: ["*"]
  auth:
    enabled: true
    # python -c 'import base64; print("Basic " + base64.b64encode("secret:key".encode()).decode())'
    # 'secret' is the username and 'key' is the password for basic auth by default
    # If the auth is enabled, this value must be set in the "Authorization" header of the request.
    secret: ${APP_SECRET}

crawler:
  source_type: youtube
  output_dir: data/crawl
  whisper_model: small
  transcript_merge_size: 300
  youtube_short_url_domain: "https://youtu.be"

injest:
  chunk_size: 500
  chunk_overlap: 50
  injest_from: data/crawl
  default_topic: bao

llm:
  mode: openai
  max_new_tokens: 512
  context_window: 3900

embedding:
  mode: local
  embedding_size: 768

vectorstore:
  database: qdrant

qdrant:
  path: data/qdrant_local
  # path: data/qdrant_store_test
  force_disable_check_same_thread: true

local:
  embedding_hf_model_name: intfloat/multilingual-e5-base

anthropic:
  api_key: ${ANTHROPIC_API_KEY}
  eco_model: claude-3-sonnet-20240229
  supper_model: claude-3-opus-20240229

openai:
  api_key: ${OPENAI_API_KEY}
  eco_model: gpt-3.5-turbo-0125
  super_model: gpt-4-0125-preview

google_api:
  api_key: ${GOOGLE_API_KEY}
  model: gemini-pro

reranker:
  enabled: true
  cohere:
    api_key: ${COHERE_API_KEY}  
    k: 8
    model: rerank-multilingual-v2.0

web_ingest:
  enabled: true
  path: "/ingest"

web_chat:
  enabled: True
  # title: "Your Youtube Asistant"
  title: "DCå†œåœº çˆ†æ–™é—®ç­”æœºå™¨äºº"
  header_color: "#6264f5"
  path: "/"
  # path: "/asistant"
  btn_undo: "â†©ï¸ åˆ é™¤ä¸Šä¸€æ¡"
  btn_clear: "ðŸ—‘ï¸  æ¸…ç©º"
  btn_submit: "æäº¤"
  # btn_undo: "â†©ï¸ Delete Previous"
  # btn_clear: "ðŸ—‘ï¸  Clear"
  # btn_submit: "Submit"
  work_mode: "æ¨¡å¼"
  # work_mode_label: "Mode"
  work_modes: 
    - "é—®ç­”"
    - "æœç´¢"
  # work_modes: 
    # - "Ask Question"
    # - "Search"
  max_history_message_len: 50
  max_history_len: 3
  frequently_asked_questions:
   - "éƒ­æ–‡è´µæ˜¯è°?"
   - "æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦æ¶ˆç­ä¸­å›½å…±äº§å…š?"
   - "å–œè”ç›Ÿæˆç«‹çš„é‡è¦æ„ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿ"

discord:
  enabled: true
  discord_token: ${DISCORD_TOKEN}
  bot_id: ${DISCORD_BOT_ID}
  chat_history_ttl: 3600
  max_history_len: 5
  max_history_message_len: 100
  reply_mode: true
  fallback_message: >
   (âŠ™ï¼¿âŠ™') æˆ‘æ²¡æœ‰æ‰¾åˆ°ç›¸å…³èµ„æ–™ã€‚å¦‚æžœä½ æœ‰å…¶å®ƒé—®é¢˜ï¼Œè¯·éšæ—¶æå‡ºã€‚  Sorry, I couldn't find relevant information to answer your question. If you have any other questions, please feel free to ask.  
   âœŒ(-â€¿-)âœŒ  âœŒ(-â€¿-)âœŒ  âœŒ(-â€¿-)âœŒ  âœŒ(-â€¿-)âœŒ   
   æƒ³è¦æœç´¢èµ„æ–™? è¯·åœ¨é—®é¢˜å‰åŠ ä¸Š */s* å¦‚â€œ/sæ–°ä¸­å›½è”é‚¦å®£è¨€çš„å†…å®¹æœ‰å“ªäº›ï¼Ÿâ€  
   å¦‚è¦æé—®ï¼Œè¯·ç›´æŽ¥é—®æˆ‘ ðŸ˜¯  
  frequently_asked_questions:
   - "éƒ­æ–‡è´µæ˜¯è°?"
   - "æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦æ¶ˆç­ä¸­å›½å…±äº§å…š?"
   - "å–œè”ç›Ÿæˆç«‹çš„é‡è¦æ„ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿ"

retriever:
  k: 12
  # collection_name: llm_lessions
  collection_name: bao
  score_threshold: 0.85
  metadata:
    video: str
    pub_date: str
    source: str
    title: str
    start_at: int
    pub_year: str
    pub_year_month: str
    topic: str
    chunk_no: int


chain_templates:
  intent_classify_model: gpt-3.5
  intent_classify_template: >
    Do not answer the question. Instead, you need to follow below steps to generate a JSON object with following fields to classify the question: type: â€œgreetingâ€, "miles", â€œbao" (string) confidence: 0.0 to 1.0 (float)
    Steps:
    1.Intent Recognition: As an expert in the field of knowledge within the Whistleblower Library, you need to combine historical inquiries, analyze the current input text, and then determine the intent of the questioner
    2.å½“æœ‰å¦‚ä¸‹æ„å‘æ—¶å½’ç±»ä¸º"greeting":
      å½“æé—®è€…æƒ³äº†è§£æˆ‘ï¼›é—®æˆ‘æ˜¯è°ï¼›å’Œæˆ‘æ‰“æ‹›å‘¼ï¼›é—®å¤©æ°”ï¼›é—®æˆ‘èƒ½åšä»€ä¹ˆï¼›é—®åƒäº†å—ï¼›é—®å§“åï¼›å‡ºç”Ÿï¼Œå¹´é¾„ï¼Œæ€§åˆ«ï¼›å±žäºŽå“ªä¸ªå†œåœºçš„ï¼›å†œåœºä¸»æ˜¯è°ï¼›æ˜¯è°å¼€å‘çš„;èµžè®¸;æ„Ÿè°¢;æ‰¹è¯„;å»ºè®®ç­‰ç­‰ç±»ä¼¼é—®é¢˜ã€‚      
    3.è¯·æ³¨æ„ï¼Œéƒ­å…ˆç”Ÿï¼Œéƒ­æ–‡è´µï¼Œéƒ­ï¼Œæˆ–Miles or Miles GuoæŒ‡åŒä¸€ä¸ªäººï¼Œä¸‹é¢ç»Ÿä¸€ç§°éƒ­æ–‡è´µ
    4.å½“ç¬¦åˆå¦‚ä¸‹æ„å‘æ—¶å½’ç±»ä¸º"miles":
      æƒ³äº†è§£éƒ­æ–‡è´µï¼Œå¦‚â€œä»‹ç»éƒ­æ–‡è´µâ€ï¼Œâ€œä»‹ç»éƒ­æ–‡è´µçˆ†æ–™â€ï¼Œâ€œéƒ­æ–‡è´µæ˜¯è°ï¼Ÿä¸ºä»€ä¹ˆè¦çˆ†æ–™ï¼Ÿâ€ï¼Œâ€œéƒ­æ–‡è´µçˆ†è°çš„æ–™â€ï¼Œâ€œéƒ­æ–‡è´µå‡ºç”Ÿå’ŒèƒŒæ™¯â€ï¼Œâ€å’Œ8964çš„è”ç³»â€œï¼Œâ€éƒ­æ–‡è´µå’Œä¸­å›½å…±äº§å…šçš„åˆ©ç›Šæˆ–åŽ‰å®³å…³ç³»â€œï¼Œâ€éƒ­æ–‡è´µä¸ºä»€ä¹ˆè¢«å…³æŠ¼â€œï¼Œâ€éƒ­æ–‡è´µçš„å®¶äººå’Œå‘˜å·¥æƒ…å†µâ€œï¼Œâ€éƒ­æ–‡è´µç›¸å…³æ³•å¾‹çº çº·â€œï¼Œâ€œéƒ­æ–‡è´µåº­å®¡æˆ–å¼€åº­æ—¶é—´æˆ–è¿›å±•æˆ–ç»“æžœâ€ç­‰ç­‰æˆ–ç±»ä¼¼ä¸Šé¢çš„é—®é¢˜ã€‚
      æƒ³äº†çˆ†æ–™é©å‘½ï¼Œå¦‚â€ä»‹ç»çˆ†æ–™é©å‘½â€œï¼Œâ€œéƒ­æ–‡è´µä¸ºä»€ä¹ˆè¦çˆ†æ–™ï¼Ÿâ€ï¼Œ â€œéƒ­å…ˆç”Ÿçš„çˆ†æ–™çš„æ—¶é—´çº¿â€ï¼Œâ€éƒ­çˆ†æ–™æ¶‰åŠä¸»è¦äººç‰©â€œï¼Œâ€éƒ­å…ˆç”Ÿä»€ä¹ˆæ—¶å€™å¼€å§‹çˆ†æ–™â€œï¼Œâ€å…±äº§å…šä¸ºä»€ä¹ˆè¦é˜»æ­¢éƒ­æ–‡è´µçˆ†æ–™ï¼Ÿâ€œç­‰ç­‰ï¼Œ æˆ–ç±»ä¼¼ä¸Šé¢çš„é—®é¢˜ã€‚
    5.å½“ä¸ç¡®å®šæˆ–ä¸èƒ½å½’ä¸ºä¸Šé¢çš„ç±»åˆ«æ—¶ï¼Œå½’ç±»ä¸º"bao"ï¼Œæ¯”å¦‚ï¼š
      æƒ³äº†è§£éƒ­å…ˆç”Ÿå¯¹æŸäº‹æˆ–å¯¹æŸäººçš„çœ‹æ³•ï¼Œæˆ–ç±»ä¼¼é—®é¢˜
      å…¶å®ƒé—®é¢˜
  answer_model: anthropic-sonnet
  answer_template: >
    ä½ æ˜¯ä¸€ä½é˜…è¯»åˆ†æžå’Œå†™ä½œé¢†åŸŸçš„ä¸“å®¶ã€‚è¯·ä»…ä½¿ç”¨ä»¥ä¸‹ä»£ç å—ä¸­çš„å†…å®¹å›žç­”é—®é¢˜ï¼Œè¦æ±‚å‡†ç¡®ã€‚å¦‚æžœä½ ä¸çŸ¥é“ç­”æ¡ˆï¼Œè¯·ä¸è¦å›žå¤ã€‚è¯·æ³¨æ„å½“æåˆ°äººç‰©åç§°ï¼šéƒ­å…ˆç”Ÿï¼Œéƒ­æ–‡è´µå’ŒMiles Guoï¼Œä»¥ä¸Šå‡æŒ‡åŒä¸€ä¸ªäººã€‚\nContext:```{context}```
  greeting_model: gemini
  greeting_template: >
    ä½ æ˜¯æ–‡æ¡£èŠå¤©æœºå™¨äººBob Washingtonï¼Œè¯·æ ¹æ®ä¸‰é‡åå¼•å·ä¸­çš„å†…å®¹å›žç­”ç”¨æˆ·çš„æé—®ï¼Œåœ¨å›žç­”çš„æœ€åŽå¦‚æžœæœ‰å¿…è¦ä½ å¯ä»¥æ ¹æ®å¦‚ä¸‹ä¸‰é‡åå¼•å·ä¸­çš„ä¿¡æ¯è¯¦ç»†ä»‹ç»è‡ªå·±ï¼Œå¹¶å‘Šè¯‰ç”¨æˆ·æ€Žä¹ˆæé—®ã€‚
    ä½ çš„å›žç­”å¯ä»¥æ˜¯markdownæ ¼å¼ï¼Œè¦æ±‚å›žç­”å…¨é¢å’Œæ¸…æ™°ã€‚å¦‚æžœä¸æ¸…æ¥šï¼Œè¯·ä¸è¦å›žç­”ï¼š
    ```æˆ‘çš„åå­—æ˜¯Bob Washingtonï¼Œ æˆ‘æ¥è‡ªå–œé©¬æ‹‰é›…åŽç››é¡¿å†œåœºï¼Œ2024å¹´2æœˆ10æ—¥æ˜¯æˆ‘çš„ç”Ÿæ—¥ã€‚åŽç››é¡¿DCå†œåœºçš„æˆ˜å‹åˆ›å»ºäº†æˆ‘. 
    æˆ‘èƒ½å¤Ÿä¸ºä½ æä¾›å…³äºŽçˆ†æ–™é©å‘½ç›¸å…³çŸ¥è¯†å’Œè§£ç­”ï¼Œå…¶ä¸­æ¶µç›–ä»Ž2017å¹´1æœˆåˆ°2023å¹´3æœˆçš„éƒ­å…ˆç”Ÿçš„çˆ†æ–™è§†é¢‘ã€‚å¦‚æžœå›žç­”æœ‰ä¸å®Œæ•´æˆ–æœ‰è¯¯çš„åœ°æ–¹è¯·å¤šå‘å†œåœºå…‰æ˜Žæˆ˜å‹æå‡ºã€‚ä¹Ÿè¯·ä½ æ ¹æ®å›žç­”ä¸­çš„å‚è€ƒéƒ¨åˆ†è¿›è¡Œå‚è€ƒï¼Œå¦‚æžœå›žç­”ä¸‹æ–¹æ²¡æœ‰é™„å¸¦å¼•ç”¨å‚è€ƒï¼Œè¯·å¯¹æˆ‘çš„å›žç­”ä¿æŒè°¨æ…Žæ€åº¦ã€‚ä½ å¯ä»¥æŒ‰å¦‚ä¸‹å‡ ç§æ–¹å¼æé—®ï¼š
    1.ç›´æŽ¥æé—®ï¼Œæ¯”å¦‚ï¼šâ€œå“ªäº›è§†é¢‘è®²è´¢æ–°ç½‘å’Œèƒ¡èˆ’ç«‹ï¼Ÿâ€ï¼Œâ€œæ¨æ”¹å…°å¥³å£«æ˜¯ä¸­å›½å“ªä¸ªåœ°æ–¹çš„äººï¼Ÿå¥¹ç”Ÿå‰é­å—äº†ä»€ä¹ˆä¸å…¬ï¼Ÿâ€ï¼Œâ€œå–œè”ç›Ÿæˆç«‹çš„æ„ä¹‰æ˜¯ï¼Ÿâ€
    2.å¦‚æžœä½ å·²ç»æ¸…æ¥šè§†é¢‘å¹´ä»½æœˆä»½æˆ–æ—¥æœŸï¼Œå¯ä»¥è®©å›žç­”æ›´æœ‰é’ˆå¯¹æ€§ï¼Œæ¯”å¦‚ï¼š"2020å¹´çš„è§†é¢‘ä¸­ï¼Œéƒ­å…ˆç”Ÿæåˆ°äº†æ¨æ”¹å…°ï¼Œå¥¹é­å—äº†ä»€ä¹ˆï¼Ÿ"ï¼Œ "2021å¹´4æœˆ27æ—¥ï¼Œéƒ­å…ˆç”Ÿæåˆ°äº†å–œå¸ä¸Šå¸‚ï¼Œæœ‰ä½•é‡å¤§æ„ä¹‰ï¼Ÿ"
    3.å¦‚æžœä½ çŸ¥é“è§†é¢‘æ¥æºï¼Œå¹¶èƒ½æä¾›è§†é¢‘é“¾æŽ¥ï¼Œæˆ‘çš„å›žç­”ä¼šæ›´å…·é’ˆå¯¹æ€§ã€‚æ¯”å¦‚ï¼šè§†é¢‘https://youtu.be/7D_t9a8faA0  é‡Œï¼Œéƒ­å…ˆç”Ÿæ€Žä¹ˆè¯„ä»·é’å³°çœ‹å®ˆæ‰€çš„å‹‡å£«çš„ï¼Ÿ
    4.å¦‚æžœä½ åªæƒ³æœç´¢ï¼Œéžå¸¸ç®€å•ï¼šåœ¨ä½ çš„é—®é¢˜å‰é¢åŠ ä¸Š /s, æ¯”å¦‚,"/sè§†é¢‘https://youtu.be/7D_t9a8faA0  é‡Œï¼Œéƒ­å…ˆç”Ÿæ€Žä¹ˆè¯„ä»·é’å³°çœ‹å®ˆæ‰€çš„å‹‡å£«çš„ï¼Ÿ"
    ```
    Input: {question}
    Output:

  query_rewrite_model: anthropic-sonnet
  query_rewrite_template: >
    DO NOT answer the question. Instead, you need to follow below steps one by one to generate a valid JSON object with following fields:
    1. If there's a specific date mentioned for "live stream", "video", or "leak", store it in the "pub-date" field in the yyyyMMdd format (e.g., 20240308 for March 8, year 2024). If no date is explicitly mentioned, leave the "pub-date" field empty.
    2. If there is an explicit year number to describe the live broadcast, video, or news, please store it in the "pub-year" field in yyyy format(e.g., 2024 for year 2024). Otherwise, do not extract it.
    3. If there is an explicit year and month to describe the live broadcast, video, or news, please store it in the "pub-year-month" field in yyyyMM format. Otherwise, do not extract it.
    Please Note: "pub-date", "pub-year", and "pub-year_month" should be in '0'-'9'.
    4. If there is a live broadcast or video playback link, please extract it and store it in the "video" field. Otherwise, do not extract it.
    5. Construct an independent question that can be understood without the chat history. Do not answer the question, just reconstruct it and put it in the "query" field. You need to remove any date, year, month, and links from "query".
    6. Ensemble the above fields into a valid JSON object and then return it.